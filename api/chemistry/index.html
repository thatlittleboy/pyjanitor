
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://pyjanitor-devs.github.io/pyjanitor/api/chemistry/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>Chemistry - pyjanitor documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#546d78">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/nb_mods.css">
    
      <link rel="stylesheet" href="../../css/apidocs.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/nord.min.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue-grey" data-md-color-accent="blue-grey">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chemistry" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="pyjanitor documentation" class="md-header__button md-logo" aria-label="pyjanitor documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyjanitor documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chemistry
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/pyjanitor-devs/pyjanitor/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pyjanitor-devs/pyjanitor
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="pyjanitor documentation" class="md-nav__button md-logo" aria-label="pyjanitor documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"/></svg>

    </a>
    pyjanitor documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/pyjanitor-devs/pyjanitor/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pyjanitor-devs/pyjanitor
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../devguide/" class="md-nav__link">
        Development Guide
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../functions/" class="md-nav__link">
        Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../biology/" class="md-nav__link">
        Biology
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chemistry
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Chemistry
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#janitor.chemistry" class="md-nav__link">
    janitor.chemistry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.chemistry.maccs_keys_fingerprint" class="md-nav__link">
    maccs_keys_fingerprint()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.chemistry.molecular_descriptors" class="md-nav__link">
    molecular_descriptors()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.chemistry.morgan_fingerprint" class="md-nav__link">
    morgan_fingerprint()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.chemistry.smiles2mol" class="md-nav__link">
    smiles2mol()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../engineering/" class="md-nav__link">
        Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../finance/" class="md-nav__link">
        Finance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        Input/Output (io)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ml/" class="md-nav__link">
        Machine Learning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../math/" class="md-nav__link">
        Math
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pyspark/" class="md-nav__link">
        PySpark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../timeseries/" class="md-nav__link">
        Timeseries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xarray/" class="md-nav__link">
        XArray
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../CHANGELOG/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../AUTHORS/" class="md-nav__link">
        Authors
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#janitor.chemistry" class="md-nav__link">
    janitor.chemistry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.chemistry.maccs_keys_fingerprint" class="md-nav__link">
    maccs_keys_fingerprint()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.chemistry.molecular_descriptors" class="md-nav__link">
    molecular_descriptors()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.chemistry.morgan_fingerprint" class="md-nav__link">
    morgan_fingerprint()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#janitor.chemistry.smiles2mol" class="md-nav__link">
    smiles2mol()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/pyjanitor-devs/pyjanitor/edit/master/docs/api/chemistry.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chemistry">Chemistry</h1>


  <div class="doc doc-object doc-module">

<a id="janitor.chemistry"></a>
    <div class="doc doc-contents first">

      <p>Chemistry and cheminformatics-oriented data cleaning functions.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h2 id="janitor.chemistry.maccs_keys_fingerprint" class="doc doc-heading">
<code class="highlight language-python">maccs_keys_fingerprint(df, mols_column_name)</code>


</h2>

    <div class="doc doc-contents ">

      <p>Convert a column of RDKIT mol objects into MACCS Keys Fingerprints.</p>
<p>Returns a new dataframe without any of the original data.
This is intentional to leave the user with the data requested.</p>
<p>This method does not mutate the original DataFrame.</p>
<p>Functional usage example:</p>
<pre><code class="language-python">import pandas as pd
import janitor.chemistry

df = pd.DataFrame(...)

maccs = janitor.chemistry.maccs_keys_fingerprint(
    df=df.smiles2mol('smiles', 'mols'),
    mols_column_name='mols'
)
</code></pre>
<p>Method chaining usage example:</p>
<pre><code class="language-python">import pandas as pd
import janitor.chemistry

df = pd.DataFrame(...)

maccs = (
    df.smiles2mol('smiles', 'mols')
        .maccs_keys_fingerprint(mols_column_name='mols')
)
</code></pre>
<p>If you wish to join the maccs keys fingerprints back into the
original dataframe, this can be accomplished by doing a <code>join</code>,
because the indices are preserved:</p>
<pre><code class="language-python">joined = df.join(maccs_keys_fingerprint)
</code></pre>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>DataFrame</code></td>
        <td><p>A pandas DataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mols_column_name</code></td>
        <td><code>Hashable</code></td>
        <td><p>The name of the column that has the RDKIT mol objects.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>A new pandas DataFrame of MACCS keys fingerprints.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>janitor/chemistry.py</code></summary>
          <pre class="highlight"><code class="language-python">@pf.register_dataframe_method
@deprecated_alias(mols_col="mols_column_name")
def maccs_keys_fingerprint(
    df: pd.DataFrame, mols_column_name: Hashable
) -&gt; pd.DataFrame:
    """
    Convert a column of RDKIT mol objects into MACCS Keys Fingerprints.

    Returns a new dataframe without any of the original data.
    This is intentional to leave the user with the data requested.

    This method does not mutate the original DataFrame.

    Functional usage example:

    ```python
    import pandas as pd
    import janitor.chemistry

    df = pd.DataFrame(...)

    maccs = janitor.chemistry.maccs_keys_fingerprint(
        df=df.smiles2mol('smiles', 'mols'),
        mols_column_name='mols'
    )
    ```

    Method chaining usage example:

    ```python
    import pandas as pd
    import janitor.chemistry

    df = pd.DataFrame(...)

    maccs = (
        df.smiles2mol('smiles', 'mols')
            .maccs_keys_fingerprint(mols_column_name='mols')
    )
    ```

    If you wish to join the maccs keys fingerprints back into the
    original dataframe, this can be accomplished by doing a `join`,
    because the indices are preserved:

    ```python
    joined = df.join(maccs_keys_fingerprint)
    ```

    :param df: A pandas DataFrame.
    :param mols_column_name: The name of the column that has the RDKIT mol
        objects.
    :returns: A new pandas DataFrame of MACCS keys fingerprints.
    """

    maccs = [GetMACCSKeysFingerprint(m) for m in df[mols_column_name]]

    np_maccs = []

    for macc in maccs:
        arr = np.zeros((1,))
        DataStructs.ConvertToNumpyArray(macc, arr)
        np_maccs.append(arr)
    np_maccs = np.vstack(np_maccs)
    fmaccs = pd.DataFrame(np_maccs)
    fmaccs.index = df.index
    return fmaccs
</code></pre>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="janitor.chemistry.molecular_descriptors" class="doc doc-heading">
<code class="highlight language-python">molecular_descriptors(df, mols_column_name)</code>


</h2>

    <div class="doc doc-contents ">

      <p>Convert a column of RDKIT mol objects into a Pandas DataFrame
of molecular descriptors.</p>
<p>Returns a new dataframe without any of the original data. This is
intentional to leave the user only with the data requested.</p>
<p>This method does not mutate the original DataFrame.</p>
<p>The molecular descriptors are from the rdkit.Chem.rdMolDescriptors:</p>
<pre><code>Chi0n, Chi0v, Chi1n, Chi1v, Chi2n, Chi2v, Chi3n, Chi3v,
Chi4n, Chi4v, ExactMolWt, FractionCSP3, HallKierAlpha, Kappa1,
Kappa2, Kappa3, LabuteASA, NumAliphaticCarbocycles,
NumAliphaticHeterocycles, NumAliphaticRings, NumAmideBonds,
NumAromaticCarbocycles, NumAromaticHeterocycles, NumAromaticRings,
NumAtomStereoCenters, NumBridgeheadAtoms, NumHBA, NumHBD,
NumHeteroatoms, NumHeterocycles, NumLipinskiHBA, NumLipinskiHBD,
NumRings, NumSaturatedCarbocycles, NumSaturatedHeterocycles,
NumSaturatedRings, NumSpiroAtoms, NumUnspecifiedAtomStereoCenters,
TPSA.
</code></pre>
<p>Functional usage example:</p>
<pre><code class="language-python">import pandas as pd
import janitor.chemistry

df = pd.DataFrame(...)

mol_desc = (
    janitor.chemistry.molecular_descriptors(
        df=df.smiles2mol('smiles', 'mols'),
        mols_column_name='mols'
    )
)
</code></pre>
<p>Method chaining usage example:</p>
<pre><code class="language-python">
import pandas as pd
import janitor.chemistry

df = pd.DataFrame(...)

mol_desc = (
    df.smiles2mol('smiles', 'mols')
    .molecular_descriptors(mols_column_name='mols')
)
</code></pre>
<p>If you wish to join the molecular descriptors back into the original
dataframe, this can be accomplished by doing a <code>join</code>,
because the indices are preserved:</p>
<pre><code class="language-python">joined = df.join(mol_desc)
</code></pre>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>DataFrame</code></td>
        <td><p>A pandas DataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mols_column_name</code></td>
        <td><code>Hashable</code></td>
        <td><p>The name of the column that has the RDKIT mol objects.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>A new pandas DataFrame of molecular descriptors.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>janitor/chemistry.py</code></summary>
          <pre class="highlight"><code class="language-python">@pf.register_dataframe_method
@deprecated_alias(mols_col="mols_column_name")
def molecular_descriptors(
    df: pd.DataFrame, mols_column_name: Hashable
) -&gt; pd.DataFrame:
    """
    Convert a column of RDKIT mol objects into a Pandas DataFrame
    of molecular descriptors.

    Returns a new dataframe without any of the original data. This is
    intentional to leave the user only with the data requested.

    This method does not mutate the original DataFrame.

    The molecular descriptors are from the rdkit.Chem.rdMolDescriptors:

    ```
    Chi0n, Chi0v, Chi1n, Chi1v, Chi2n, Chi2v, Chi3n, Chi3v,
    Chi4n, Chi4v, ExactMolWt, FractionCSP3, HallKierAlpha, Kappa1,
    Kappa2, Kappa3, LabuteASA, NumAliphaticCarbocycles,
    NumAliphaticHeterocycles, NumAliphaticRings, NumAmideBonds,
    NumAromaticCarbocycles, NumAromaticHeterocycles, NumAromaticRings,
    NumAtomStereoCenters, NumBridgeheadAtoms, NumHBA, NumHBD,
    NumHeteroatoms, NumHeterocycles, NumLipinskiHBA, NumLipinskiHBD,
    NumRings, NumSaturatedCarbocycles, NumSaturatedHeterocycles,
    NumSaturatedRings, NumSpiroAtoms, NumUnspecifiedAtomStereoCenters,
    TPSA.
    ```

    Functional usage example:

    ```python
    import pandas as pd
    import janitor.chemistry

    df = pd.DataFrame(...)

    mol_desc = (
        janitor.chemistry.molecular_descriptors(
            df=df.smiles2mol('smiles', 'mols'),
            mols_column_name='mols'
        )
    )
    ```

    Method chaining usage example:

    ```python

    import pandas as pd
    import janitor.chemistry

    df = pd.DataFrame(...)

    mol_desc = (
        df.smiles2mol('smiles', 'mols')
        .molecular_descriptors(mols_column_name='mols')
    )
    ```

    If you wish to join the molecular descriptors back into the original
    dataframe, this can be accomplished by doing a `join`,
    because the indices are preserved:

    ```python
    joined = df.join(mol_desc)
    ```

    :param df: A pandas DataFrame.
    :param mols_column_name: The name of the column that has the RDKIT mol
        objects.
    :returns: A new pandas DataFrame of molecular descriptors.
    """
    descriptors = [
        CalcChi0n,
        CalcChi0v,
        CalcChi1n,
        CalcChi1v,
        CalcChi2n,
        CalcChi2v,
        CalcChi3n,
        CalcChi3v,
        CalcChi4n,
        CalcChi4v,
        CalcExactMolWt,
        CalcFractionCSP3,
        CalcHallKierAlpha,
        CalcKappa1,
        CalcKappa2,
        CalcKappa3,
        CalcLabuteASA,
        CalcNumAliphaticCarbocycles,
        CalcNumAliphaticHeterocycles,
        CalcNumAliphaticRings,
        CalcNumAmideBonds,
        CalcNumAromaticCarbocycles,
        CalcNumAromaticHeterocycles,
        CalcNumAromaticRings,
        CalcNumAtomStereoCenters,
        CalcNumBridgeheadAtoms,
        CalcNumHBA,
        CalcNumHBD,
        CalcNumHeteroatoms,
        CalcNumHeterocycles,
        CalcNumLipinskiHBA,
        CalcNumLipinskiHBD,
        CalcNumRings,
        CalcNumSaturatedCarbocycles,
        CalcNumSaturatedHeterocycles,
        CalcNumSaturatedRings,
        CalcNumSpiroAtoms,
        CalcNumUnspecifiedAtomStereoCenters,
        CalcTPSA,
    ]
    descriptors_mapping = {f.__name__.strip("Calc"): f for f in descriptors}

    feats = dict()
    for name, func in descriptors_mapping.items():
        feats[name] = [func(m) for m in df[mols_column_name]]
    return pd.DataFrame(feats)
</code></pre>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="janitor.chemistry.morgan_fingerprint" class="doc doc-heading">
<code class="highlight language-python">morgan_fingerprint(df, mols_column_name, radius=3, nbits=2048, kind='counts')</code>


</h2>

    <div class="doc doc-contents ">

      <p>Convert a column of RDKIT Mol objects into Morgan Fingerprints.</p>
<p>Returns a new dataframe without any of the original data. This is
intentional, as Morgan fingerprints are usually high-dimensional
features.</p>
<p>This method does not mutate the original DataFrame.</p>
<p>Functional usage example:</p>
<pre><code class="language-python">import pandas as pd
import janitor.chemistry

df = pd.DataFrame(...)

# For &quot;counts&quot; kind
morgans = janitor.chemistry.morgan_fingerprint(
    df=df.smiles2mol('smiles', 'mols'),
    mols_column_name='mols',
    radius=3,      # Defaults to 3
    nbits=2048,    # Defaults to 2048
    kind='counts'  # Defaults to &quot;counts&quot;
)

# For &quot;bits&quot; kind
morgans = janitor.chemistry.morgan_fingerprint(
    df=df.smiles2mol('smiles', 'mols'),
    mols_column_name='mols',
    radius=3,      # Defaults to 3
    nbits=2048,    # Defaults to 2048
    kind='bits'    # Defaults to &quot;counts&quot;
)
</code></pre>
<p>Method chaining usage example:</p>
<pre><code class="language-python">import pandas as pd
import janitor.chemistry

df = pd.DataFrame(...)

# For &quot;counts&quot; kind
morgans = (
    df.smiles2mol('smiles', 'mols')
    .morgan_fingerprint(
        mols_column_name='mols',
        radius=3,      # Defaults to 3
        nbits=2048,    # Defaults to 2048
        kind='counts'  # Defaults to &quot;counts&quot;
    )
)

# For &quot;bits&quot; kind
morgans = (
    df
    .smiles2mol('smiles', 'mols')
    .morgan_fingerprint(
        mols_column_name='mols',
        radius=3,    # Defaults to 3
        nbits=2048,  # Defaults to 2048
        kind='bits'  # Defaults to &quot;counts&quot;
    )
)
</code></pre>
<p>If you wish to join the morgan fingerprints back into the original
dataframe, this can be accomplished by doing a <code>join</code>,
because the indices are preserved:</p>
<pre><code class="language-python">joined = df.join(morgans)
</code></pre>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>DataFrame</code></td>
        <td><p>A pandas DataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mols_column_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column that has the RDKIT mol objects</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>radius</code></td>
        <td><code>int</code></td>
        <td><p>Radius of Morgan fingerprints. Defaults to 3.</p></td>
        <td><code>3</code></td>
      </tr>
      <tr>
        <td><code>nbits</code></td>
        <td><code>int</code></td>
        <td><p>The length of the fingerprints. Defaults to 2048.</p></td>
        <td><code>2048</code></td>
      </tr>
      <tr>
        <td><code>kind</code></td>
        <td><code>str</code></td>
        <td><p>Whether to return counts or bits. Defaults to counts.</p></td>
        <td><code>&#39;counts&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>A new pandas DataFrame of Morgan fingerprints.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if <code>kind</code> is not one of <code>"counts"</code> or `"bits"``.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>janitor/chemistry.py</code></summary>
          <pre class="highlight"><code class="language-python">@pf.register_dataframe_method
@deprecated_alias(mols_col="mols_column_name")
def morgan_fingerprint(
    df: pd.DataFrame,
    mols_column_name: str,
    radius: int = 3,
    nbits: int = 2048,
    kind: str = "counts",
) -&gt; pd.DataFrame:
    """
    Convert a column of RDKIT Mol objects into Morgan Fingerprints.

    Returns a new dataframe without any of the original data. This is
    intentional, as Morgan fingerprints are usually high-dimensional
    features.

    This method does not mutate the original DataFrame.

    Functional usage example:

    ```python
    import pandas as pd
    import janitor.chemistry

    df = pd.DataFrame(...)

    # For "counts" kind
    morgans = janitor.chemistry.morgan_fingerprint(
        df=df.smiles2mol('smiles', 'mols'),
        mols_column_name='mols',
        radius=3,      # Defaults to 3
        nbits=2048,    # Defaults to 2048
        kind='counts'  # Defaults to "counts"
    )

    # For "bits" kind
    morgans = janitor.chemistry.morgan_fingerprint(
        df=df.smiles2mol('smiles', 'mols'),
        mols_column_name='mols',
        radius=3,      # Defaults to 3
        nbits=2048,    # Defaults to 2048
        kind='bits'    # Defaults to "counts"
    )
    ```

    Method chaining usage example:

    ```python
    import pandas as pd
    import janitor.chemistry

    df = pd.DataFrame(...)

    # For "counts" kind
    morgans = (
        df.smiles2mol('smiles', 'mols')
        .morgan_fingerprint(
            mols_column_name='mols',
            radius=3,      # Defaults to 3
            nbits=2048,    # Defaults to 2048
            kind='counts'  # Defaults to "counts"
        )
    )

    # For "bits" kind
    morgans = (
        df
        .smiles2mol('smiles', 'mols')
        .morgan_fingerprint(
            mols_column_name='mols',
            radius=3,    # Defaults to 3
            nbits=2048,  # Defaults to 2048
            kind='bits'  # Defaults to "counts"
        )
    )
    ```

    If you wish to join the morgan fingerprints back into the original
    dataframe, this can be accomplished by doing a `join`,
    because the indices are preserved:

    ```python
    joined = df.join(morgans)
    ```

    :param df: A pandas DataFrame.
    :param mols_column_name: The name of the column that has the RDKIT
        mol objects
    :param radius: Radius of Morgan fingerprints. Defaults to 3.
    :param nbits: The length of the fingerprints. Defaults to 2048.
    :param kind: Whether to return counts or bits. Defaults to counts.
    :returns: A new pandas DataFrame of Morgan fingerprints.
    :raises ValueError: if `kind` is not one of
        `"counts"` or `"bits"``.
    """
    acceptable_kinds = ["counts", "bits"]
    if kind not in acceptable_kinds:
        raise ValueError(f"`kind` must be one of {acceptable_kinds}")

    if kind == "bits":
        fps = [
            GetMorganFingerprintAsBitVect(m, radius, nbits, useChirality=True)
            for m in df[mols_column_name]
        ]
    elif kind == "counts":
        fps = [
            GetHashedMorganFingerprint(m, radius, nbits, useChirality=True)
            for m in df[mols_column_name]
        ]

    np_fps = []
    for fp in fps:
        arr = np.zeros((1,))
        DataStructs.ConvertToNumpyArray(fp, arr)
        np_fps.append(arr)
    np_fps = np.vstack(np_fps)
    fpdf = pd.DataFrame(np_fps)
    fpdf.index = df.index
    return fpdf
</code></pre>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="janitor.chemistry.smiles2mol" class="doc doc-heading">
<code class="highlight language-python">smiles2mol(df, smiles_column_name, mols_column_name, drop_nulls=True, progressbar=None)</code>


</h2>

    <div class="doc doc-contents ">

      <p>Convert a column of SMILES strings into RDKit Mol objects.</p>
<p>Automatically drops invalid SMILES, as determined by RDKIT.</p>
<p>This method mutates the original DataFrame.</p>
<p>Functional usage example:</p>
<pre><code class="language-python">import pandas as pd
import janitor.chemistry

df = pd.DataFrame(...)

df = janitor.chemistry.smiles2mol(
    df=df,
    smiles_column_name='smiles',
    mols_column_name='mols'
)
</code></pre>
<p>Method chaining usage example:</p>
<pre><code class="language-python">import pandas as pd
import janitor.chemistry

df = pd.DataFrame(...)

df = df.smiles2mol(
    smiles_column_name='smiles',
    mols_column_name='mols'
)
</code></pre>
<p>A progressbar can be optionally used.</p>
<ul>
<li>Pass in "notebook" to show a <code>tqdm</code> notebook progressbar.
  (<code>ipywidgets</code> must be enabled with your Jupyter installation.)</li>
<li>Pass in "terminal" to show a <code>tqdm</code> progressbar. Better suited for use
  with scripts.</li>
<li>"none" is the default value - progress bar will be not be shown.</li>
</ul>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>DataFrame</code></td>
        <td><p>pandas DataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>smiles_column_name</code></td>
        <td><code>Hashable</code></td>
        <td><p>Name of column that holds the SMILES strings.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mols_column_name</code></td>
        <td><code>Hashable</code></td>
        <td><p>Name to be given to the new mols column.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>drop_nulls</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to drop rows whose mols failed to be constructed.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progressbar</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Whether to show a progressbar or not.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>A pandas DataFrame with new RDKIT Mol objects column.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if <code>progressbar</code> is not one of <code>"notebook"``,</code>"terminal"<code>, or `None</code>.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>janitor/chemistry.py</code></summary>
          <pre class="highlight"><code class="language-python">@pf.register_dataframe_method
@deprecated_alias(smiles_col="smiles_column_name", mols_col="mols_column_name")
def smiles2mol(
    df: pd.DataFrame,
    smiles_column_name: Hashable,
    mols_column_name: Hashable,
    drop_nulls: bool = True,
    progressbar: Optional[str] = None,
) -&gt; pd.DataFrame:
    """
    Convert a column of SMILES strings into RDKit Mol objects.

    Automatically drops invalid SMILES, as determined by RDKIT.

    This method mutates the original DataFrame.

    Functional usage example:

    ```python
    import pandas as pd
    import janitor.chemistry

    df = pd.DataFrame(...)

    df = janitor.chemistry.smiles2mol(
        df=df,
        smiles_column_name='smiles',
        mols_column_name='mols'
    )
    ```

    Method chaining usage example:

    ```python
    import pandas as pd
    import janitor.chemistry

    df = pd.DataFrame(...)

    df = df.smiles2mol(
        smiles_column_name='smiles',
        mols_column_name='mols'
    )
    ```

    A progressbar can be optionally used.

    - Pass in "notebook" to show a `tqdm` notebook progressbar.
      (`ipywidgets` must be enabled with your Jupyter installation.)
    - Pass in "terminal" to show a `tqdm` progressbar. Better suited for use
      with scripts.
    - "none" is the default value - progress bar will be not be shown.

    :param df: pandas DataFrame.
    :param smiles_column_name: Name of column that holds the SMILES strings.
    :param mols_column_name: Name to be given to the new mols column.
    :param drop_nulls: Whether to drop rows whose mols failed to be
        constructed.
    :param progressbar: Whether to show a progressbar or not.
    :returns: A pandas DataFrame with new RDKIT Mol objects column.
    :raises ValueError: if `progressbar` is not one of
        `"notebook"``, `"terminal"``, or `None``.
    """
    valid_progress = ["notebook", "terminal", None]
    if progressbar not in valid_progress:
        raise ValueError(f"progressbar kwarg must be one of {valid_progress}")

    if progressbar is None:
        df[mols_column_name] = df[smiles_column_name].apply(
            lambda x: Chem.MolFromSmiles(x)
        )
    else:
        if progressbar == "notebook":
            tqdmn().pandas(desc="mols")
        elif progressbar == "terminal":
            tqdm.pandas(desc="mols")
        df[mols_column_name] = df[smiles_column_name].progress_apply(
            lambda x: Chem.MolFromSmiles(x)
        )

    if drop_nulls:
        df = df.dropna(subset=[mols_column_name])
    df = df.reset_index(drop=True)
    return df
</code></pre>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../biology/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Biology" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Biology
            </div>
          </div>
        </a>
      
      
        
        <a href="../engineering/" class="md-footer__link md-footer__link--next" aria-label="Next: Engineering" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Engineering
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["instant"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.b1047164.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
      
        <script src="../../js/config.js"></script>
      
    
  </body>
</html>